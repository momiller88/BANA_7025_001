## Pizza Project Mid-Term {.tabset .tabset-fade}
**Authors: Sidney Schaeper & Morgan Miller **

### Introduction
### Packages Required
#### **Packages**
The packages that are need for this evaluation are the readr, dplyr, and ggplot2. The readr package helps us import the datasets for this project. You can find more information on the readr package by clicking [here](https://cran.r-project.org/web/packages/readr/readr.pdf). The dplyr package helps us clean the datasets. You can find more information on the dplyr package by clicking [here](https://www.rdocumentation.org/packages/dplyr/versions/0.7.8). The ggplot2 package helps us create visualizations for these datasets. You can find more information on the ggplot2 package by clicking [here](https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf). The first section of code allows you to install the packages. The second section of code allows you to load the packages into R. You need to run both of these sections of code in order to get these packages into R. 

##### **Code to Install Packages**
```{r eval=FALSE}
#Install packages necessary for this project#
install.packages("readr")
install.packages("dplyr")
install.packages("ggplot2")
```

##### **Code to Find Packages in the Library**
```{r results = "hide", warning = FALSE, message = FALSE}
#Load the installed packages into R#
library(readr)
library(dplyr)
library(ggplot2)
```

### Data Preparation
#### **Original Data Dictionary**

##### **Pizza Jared Variables**
Variable | Class | Description
---------|-------|------------
polla_qid | integer | quiz id
answer | character | answer (likert scale)
votes | integer | number of votes for that question/answer combo
pollq_id | integer | poll question id
question | character | pizza place
time | integer | time of quiz
total_votes | integer | total number of votes for that pizza place
percent | double | vote percent of total for that pizza place

##### **Pizza Barstool Variables**
Variable | Class | Description
---------|-------|------------
name | character | pizza place name
address1 | character | pizza place address
city | character | city
zip | double | zip
country | character | country
latitude | double | latitude
longitude | double | longitude 
price_level | double | price rating (0=cheap and 3=expensive)
provider_rating | double | provider review score
provider_review_count | double | provider review count 
review_stats_all_average_score | double | average score
review_stats_all_count | double | count of all reviews
review_stas_all_total_score | double | review total score
review_stats_community_average_score | double | community average score
review_stats_community_count | double | community review count
review_stats_community_total_score | double | community review total score
review_stats_critic_average_score | double | critic average score
review_stats_critic_count | double | critic review count
review_stats_critic_total_score | double | critic total score
review_stats_dave_average_score | double | Dave (Barstool) average score
review_stats_dave_count | double | Dave review count
review_stats_dave_total_score | double | Dave total score

##### **Pizza Datafiniti Variables**
Variable | Class | Description
---------|-------|------------
name | character | pizza place
address | character | address
city | character | city 
country | character | country
province | character | state
latitude | double | latitude 
longitude | double |longitude
categories | character | restaurant category
price_range_min | double | price range min
price_range_max | double | price range max

#### **Setting the Working Directory and Reading the Datasets Into R**
The following is the code to read the datasets in the R. You first need to set the working directory to wherever the datasets are located. Next, you need to read the file into R. Before you set the working directory and the read datasets into R, you need to install the packages mentioned in the prior tab. Also, you need to find them in the library. The following code shows you how to do these steps. 

```{r eval = TRUE, results = "hide", fig.show = "hide", message = FALSE, warning = FALSE}
#Set the working directory#
knitr::opts_knit$set(root.dir = getwd())

#Read the data sets into R#
barstool <- read_csv("pizza_barstool.csv")
datafiniti <- read_csv("pizza_datafiniti.csv")
jared <- read_csv("pizza_jared.csv")
```

#### **Evaluate the Column Names and Data Types** 
The first item we wanted to evaluate was the column names and the data types for each column in the barstool dataset. The first thing you should do is to make sure you have read in the dataset. Next, you should type in the following code into R. Finally, you should run the code. The head code allows us to see a piece of the data. The names code allows us to see the name of the variables within the dataset. The attributes$spec code allows us to see the data types for each of the variables.

```{r}
#See a snippet of the barstool data set#
head(barstool)

#See the variable names of the barstool data set#
names(barstool)

#See the data types for the barstool variables#
attributes(barstool)$spec
```

After evaluating the outputs of the names and data types, there are multiple changes we believe that need to be changed. The first item we believe that needs to be changed is the name for address1. We decided to change the name for address1 to address, because it seemed more consistent with the other variable names. We believe the rest of the names of the variables are fine, and we don't need to change their names. You should the run the code below to change the name for address1.  

```{r}
#Change the name of address 1 to address for the barstool data set#
names(barstool)[2] <- "address"
```

The next items I wanted to change were the data types for zip, price_level, provider_review_count, review_stats_all_count, review_stats_community_count, review_stats_critic_count, and review_stats_dave_count. We decided to change zip from a double to a character, because we wanted to maintain the zeros in front of some of the zip codes. We decided to change price_level, provider_review_count, review_stats_all_count, review_stats_community_count, review_stats_critic_count, and review_stats_dave_count from a double to integer, because there should be no decimals with these numbers. Below is the code to change these data types. 

```{r}
#Change the data type of the items mentioned above#
barstool_data_type <- transform(barstool, zip = as.character(zip), price_level = as.integer(price_level), provider_review_count = as.integer(provider_review_count), review_stats_all_count = as.integer(review_stats_all_count), review_stats_community_count = as.integer(review_stats_community_count), review_stats_critic_count = as.integer(review_stats_critic_count), review_stats_dave_count = as.integer(review_stats_dave_count))

#Check that the data types were appropriately changed#
tibble(barstool_data_type)
```

#### **Evaluate the Values for the Variables**
The next item we wanted to evaluate was the values for the variables in each data set. The first dataset we evaluated was the barstool data set. The first variable we evaluated was the name in the barstool dataset. The first line of code creates a table with all the values for the name variable and how many times they were repeated. We only wanted to look at the items that were listed more than the once. The second line of code allows us to do that. Run the code below to see the output. 

```{r}
#Creates a table of names and shows only the ones greater than 1#
barstool_names <- table(barstool_data_type$name)
barstool_names[barstool_names > 1]
```

After evaluating the output for names, we searched the internet for these places to confirm that they were the same chain restaurant. In order to search these restaurants, we need to pull in the rest of the variables to help with our search. The code below allows us to see the records where the same name was written more than once. 

```{r}
#Allows you to see the duplicate name records#
barstool_data_type[barstool_data_type$name == "Bonanno's New York Pizzeria",]
barstool_data_type[barstool_data_type$name == "Joe's Pizza",]
barstool_data_type[barstool_data_type$name == "Justino's Pizzeria",]
barstool_data_type[barstool_data_type$name == "Kiss My Slice",]
barstool_data_type[barstool_data_type$name == "Little Italy Pizza",]
barstool_data_type[barstool_data_type$name == "Lucali",]
barstool_data_type[barstool_data_type$name == "Mariella Pizza",]
barstool_data_type[barstool_data_type$name == "Patsy's Pizzeria",]
barstool_data_type[barstool_data_type$name == "Regina Pizzeria",]
barstool_data_type[barstool_data_type$name == "Steve's Pizza",]
```

After performing our search, we found that Joe's Pizza at 8th is not the same chain as Joe's Pizza at Broadway and Carmine. After discovering this information, we decided to change the name for Joe's Pizza at 8th to Joe's Pizza - 8th. Also, we discovered that the Little Italy records were not the same chain restaurant. We decided to change the first record of Little Italy Pizza to Little Italy Pizza - 45th, and we decided to change the second record of Little Italy Pizza to Little Italy Pizza - Fulton. Next, we discovered that the Lucali records were not the same restaurant chain. We decided to change the first record of Lucali to Lucali - Henry, and we decided to change the second record of Lucali to Lucali - Bay. Also, we found that the Mariella Pizza was not the same chain. We changed the first record to Mariella Pizza - Lexington, and we changed the second record to Mariella Pizza - 8th. Finally, we found that Patsy's Pizzeria records were not the same chain. We changed the first record to Patsy's Pizzeria - 1st, and we changed the second record to Patsy's Pizzeria - 2nd. The rest of the names that we found that had duplicate names were part of the same chain restaurant. The code below allows us to change the names of the items that were mentioned before. 

```{r}
#Changes the values of the restaurants that aren't part of the same chain#
barstool_data_type[c(198,238,239,248,249,265,266,310,311),]$name <- c("Joe's Pizza - 8th","Little Italy Pizza - 45th", "Little Italy Pizza - Fulton","Lucali - Henry", "Lucali - Bay", "Mariella Pizza - Lexington", "Mariella Pizza - 8th", "Patsy's Pizzeria - 1st", "Patsy's Pizzeria - 2nd")
```

The second variable we evaluated was the address in the barstool dataset. The first line of code creates a table with all the values for the address variable and how many times they were repeated. We wanted to look at the items that were listed more than the once. The second line of code allows us to do that. The third line of code allows us to see addresses where they don't start off with a house number. Run the code below to see the output. 

```{r}
#Creates a table of addresses and shows only the ones greater than 1#
barstool_addresses <- table(barstool_data_type$address)
barstool_addresses[barstool_addresses > 1]

#Shows addresses without house numbers#
barstool_data_type[barstool_data_type$address > "989 1st Ave", 2]
```

After evaluating the output for addresses, we searched the internet for these places to confirm that they were at the same location. In order to search these restaurants, we need to pull in the rest of the variables to help with our search. The code below allows us to see the records where the same address was written more than once. 

```{r}
barstool_data_type[barstool_data_type$address == "268 W 23rd St",]
barstool_data_type[barstool_data_type$address == "3131 Las Vegas Blvd S",]
barstool_data_type[barstool_data_type$address == "936 8th Ave",]
```

After performing our search, we found that the restaurants at 268 W 23rd St and 3131 Las Vegas Blvd S were both located at the same place. The restaurants at 936 8th Ave were the exact same restaurant. After evaluating both records, we decided to drop the first one, because there were more reviews in each category except provider_review_count. Below is the code to drop the first record of 936 8th Ave. 

```{r}
barstool_variable_name <- barstool_data_type[-c(250),]
```

Next, we wanted to change the address for the items that don't start with a house number, except for Broadway Between 42nd And 43rd St. We decided that it would be difficult to do any geo-location analysis without the address being correct. We decided not to change Broadway Between 42nd And 43rd St, because it showed up as the right address on google. Below is the code to change these addresses that needed to be changed. 

```{r}
barstool_variable_name[barstool_variable_name$address == "MGM Hotel & Casino Food Court", ]$address <- "3799 S Las Vegas Blvd"
barstool_variable_name[barstool_variable_name$address == "Home Depot Plz", ]$address <- "3039 NY-50"
barstool_variable_name[barstool_variable_name$address == "Pier 86 W 46th St 12th Ave", ]$address <- "Pier 86, W 46th St"
barstool_variable_name[barstool_variable_name$address == "The Metlife Building", ]$address <- "200 Park Ave"
```

### Exploratory Data Analysis 